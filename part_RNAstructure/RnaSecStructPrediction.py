#! /usr/bin/python2.7

import sys
import os
from Bio.Seq import Seq
from Bio import SeqIO
import subprocess


# runs RNAfold and returns the output
def runRNAfold(RNA):
    cmd = ['echo']
    cmd.append(RNA)
    p1 = subprocess.Popen(cmd, stdout=subprocess.PIPE)
    p2 = subprocess.Popen(['RNAfold'], stdin=p1.stdout, stdout=subprocess.PIPE)
    p1.stdout.close()
    output = p2.stdout.read()
    return str(output)


# runs RNAplot
def runRNAplot(name, RNA, struct):
    cmd = ['echo']
    cmd.append("-e")
    cmd.append(">" + name + "\n" + RNA + "\n" + struct)
    p1 = subprocess.Popen(cmd, stdout=subprocess.PIPE)
    p2 = subprocess.Popen(['RNAplot'], stdin=p1.stdout, stdout=subprocess.PIPE)
    p1.stdout.close()


# takes the output of an RNAfold or RNAcofold and returns
# the secondary structure
def get_sec_struc(output):
    out_split = output.split()
    return out_split[1]


# parses the output of RNAfold and RNAcofold and returns the energy score
def get_score(output):
    out_split = output.split("\n")[1].split(" ")[1]
    out_split = out_split[:-1]
    out_split = out_split[1:]
    energy = 0.0
    try:
        energy = float(out_split)
    except ValueError, e:
        print "Error: ", e
        print "Trying different energy parsing method..."
        try:
            out_split = output.split("\n")[1].split(" ")[2]
            out_split = out_split[:-1]
            energy = float(out_split)
        except ValueError, e:
            print "Error: ", e
            print "Second energy parsing method also not successfull. Couldn't parse energy."
    return energy


def get_sec_struct(rna_string):
    output = runRNAfold(rna_string)
    return get_sec_struct(out_split), get_score(output)

################### -- main -- ###################
if __name__ == '__main__':
    print "test"
    #na = "ACACGACGUAGCGUUAGACGUGACGUAGACGUAGAC"
    rna = "UGGUAUCAGAGCAAGGUUUUCUGUAAGUAAUUUAUGGCUUUCAUGGGGUAAAACCCUUAGAUAGGAGCCUGAGGGCUCUGCUAUGUUCUAUUUUGAGAAAAUAACUGUGUAAGUAGUAAUGCAUGAUAAAUCGAAUAAGUUCUUUACGGAUGGUCCUAAAUUUAUGAAAUCAUUCUUUUACUAUCUGAGUGAGACCCUUGUGUUUCCAAGUUCUACUGAGAAAUCAUGAGUAAAUGGACGUUGACACACUGACUUAAGGAAAAGAAAGAUGUGCCUAGGAUGAAGUCGAGCACUGUUCUAGGCUGAAGGGUGAAAAGAAAAAUGAGUUGAGUUGGGAGUAAGACUCUGAGAGGCUUGAGGCAAAAGAACCGGAACCUUACCUAGCAAAGUAAGACCCAAGGGAGGGCAGUAGCUGGAGAACCCCGGUGUGAGUUUCUUUACCUAGCAGAAGAUAUACUCUAGUAUCCUCAAAACACCGUGAAGUAUUUACAACCCUUUAUGAACAAGUAUUUUCUGGAGUUAGAUGUCAGCCACCAAAGAUCAUGAUCUAUCACAAACAAACUUGAGUCAUACAGAGAAGAACUCAGAUGUAACUGAAUGACUAAUGAUCAGGGACCUCUAUUAAAGAGCUUAGUAAGAAGUAAGUGCAUAAACUACCUCUGGAACUGGUUAUAAUCUUGAAAUGAGCAUAUGUAUCCCAAAGGUUACUCCUAUCUGUCCGUGACCAUAAGAAACCUUCUUUAAAGAAAAACUCUGGAUUCCUACUGGGAUCUUGAAUUUGAAAAGUACAAAAACUCUCAUUCCAAAUCUGUUUCAGAUCUUUCUUAUUUAGACUUAGCAUCUGCUGAUAAGGUCUCUAAUAAAGACCUUGCAUUUAAUUUACAUAUAAACACUUAUCGUAGUGAUCUUGGUUUUAAAGUCGCAAUUCACUCUUUAUCAAAAAAUCGUGAGCUGCUAAUACAGAACAGGAAGCUUUUGGAAGAACAAAAGCAGCAGCUGUCUGAAAUUAACAACCUAUCUAAGGUUGUGCGUCUCCAACGAGCUGAUUUAAAGGAGACCUUGAGAAGACAGGACGUCCUUGCGAAGGAGCUUCAGGCUCUUCGUAAAGACUAUCUGGAAAGGCGCCCUCUUAGCAAGGAGGACGUGGAAGAAUUGGUUGUCCGCAUCUCUGAACAACCAAAAAUUUAUUGAAAAAACAGACGGAAGCUCUUACUGAGGAGCUUACAAAGGAGGUUCAGGCACUGAAGCUAAUCAUCCAUAACUUCGAACAGAAGUUACUGGGAUGAGCCUGGCCGGAAGCAAGGCCACAGCAAUCUAUCAAGAAGCCUUGCAAUCUACUGCUGCUGGUUGGGAAGACACCGGCAUCGGAUUUACUGAUAAAGGAGUUAUCAGUACCACUACCCUAUCAAGGCAGCUAAAUUCGCUGUUAUUUCUGGUGAUCAAACAAAAUCAGCAGAUCACCACCAUCUCGGAAGAACUAACCCAACUUCACAACCGGGUUAAAAACCUUGAAGGAAGGACAGGGGUAUCUGCAAGCCCCCUGUAUAAAUCGGAGAUUGAAUCCAUCAACGCCAAGCUCAAAAGUAUUCAAGAUAUACAAGGGAGUCACCCUCCAAAAGAGACCCCCUCCGGAGUUAUCAAAGUUUUUGAGGAUCCCUACAGCAUCCUCCGCAGACUAUAAAUGGCGUCAAGACCUAGAGUUUCUGGGAGCACUACCAGAACCAUGAUAGCAGAACCAGGGGUUCCCCUGGUGGAUGAUCAGAUCCGGGAAUACCGGAGUGCGGCCCGAGUCGCAUACGAAGCACAAAGGAUUGCCAGACGCACUGGCAAUAUUCUUGGAAGAAUUGUUGGACGACAACCAAGGGAGCAUACCCUUGCGAUGGUCGUGGACCCCAACAGUGAGCUGGAACGCUCACUGGCUCACCGGGCACGAACAAUACCUGCUGAAGUCCUUUACAUGACCCAGCGCGGUGAGCCUACAAAUCGGGUCUAUCGGAACAGAACUGAAGAAAGGAUGCUAGUGACUCAUGGUCAGCAAGAUAGGACUUUCAUCUUGCCAGAGUCAUAUGAAGAGCUCAGGGAGGCUGGAUUUGAGUACAUCCAUCUAGGGGUACUCCAGGUGCGCAUCCAAAUUAUGCACCGAACAUAUGAUGGUACAAUGGCAUUAGUGGUCUUCCGUGACACCAGAUGGACACAGGAGAACCACCAAGACAGAUCCAUUAUAGCAACCAUGGAGGCUGAUCUCUCCCAAGGGCAUCAGCUAAUUUACGUCAUCCCAGAUAUAAUGAUGACUAUUCGGGAUUUCUACCAGCACAUUCAGAUAAGCAUCCUUACCAAAGGAUAUGAAGGCUUUCAAGGAGAAGCAAAUCUCCUUAUUACAAGAAGCUGCCGGUGCAGAUUAAGCAACGUUCCUAACGUUGGCUUCCAAUACAACAUCCAGAACGUCGUGGAAUUCUUAAAAUCUAGGGGAGUAAAAGCCCUAAAUGCGACGAAAUUAAGCACCAGGAGGUUCCAAGGAGGAGAAUGGAACAUCCGACCAUCAGAAGUGGUGGUCCCUAUGCAGCCAACAACUAUGAUAGUACGAGUUAAUUAUGACUCGUCACGAAGCAUCAGAUUCGGGGAUUAUGAAGCUAGCACAUCAUCAUCAGCCCCGAGAUAUGAGCAAGACGGUGAUGAAGAUGAAGCACUUGGUGAUAUCCAUCAAGUAAAUAUGAUCACCAUCAUAGAAGAUGAUGCAGAAGAUGACUACCCACGGUUAUCAGCUUUAGAGCGAAUAAUCGCUCCAGAAAGCAUGGUGGGAGAGGAGGACACAAUUGCUGAAUUUUUAAGCAAUCUGUCCUUAGAUUCCUCCACUGAUGAGGAAUUCUACGACGCCGACAACUCAUUAUUCGAAGAAGAAGAAUAUGAUGGGGAUUCCGAAGUUAGCACCCCAAGGAGCAAAUACAAUAUAUUUGCGCUAGAAGAUGAGUACCCAAAACUUCAACAGCUGGAAAGCCUGGUACUCUCCACAACAGAGUCUGCUAUCAGUCGCUUUAGACCAGCAGACACAGAUAUGACUGGCGUAGGCCCUGGCUACGCACCAGCAACUGGAACAGCUGGCUAUACUGGAGCCAGUUCAUCUGAUUUCCCUUACCCUAGAAGACCAAGAAAGUGGGACAACAACUCGGAGUGGUUCAACCUACCCACCGCUAACGCGAGGCAAGCAUCAAUAUUCGUUAUGCCUCAGGAUUUUGACACAAAGGUCUUUGAAAGAUGGGAAAGUUCUGUUCUCCUUCACAUGUCUGACAAGGUUUUUGAUGAUCCACAAGACAAGUUAACUUAUGUGGAAAACCUACUAGGAGAAUCAGAAAAGAAGAUGUUUAUCACUUGGAGGAUGAUGUUCACAGCUGAGUACGAAGAAAUGAAGAACAACGCUCUCGGCUCAAAUGGAACUCAAAAUAUCCUGAACCAGAUCAGGAUGAUAUUCUUUCUGGAAAAUCCCCAAGUUGGAACCACCAACACUCAAGACGCAGCAUACAAGACACUCAAACAACUAGUCUGCACAGAGAUGUCUGGACCUGCGAUCUACAGGUACCUAAAUGAUUACUUCCAUUUAGCGGCAAAAUCUGGAAGAGCGUGGGCAUCUGAUGAGCUGUCCAAGGAAUUCUUUACAAAACUGCCAAGGGGAUUAGGGGACAGAGUUGAAAAGAAAUUCAAAGAAAAGUACCCCAACAACACUAUUGGAGUAGCCCCCAGAAUCACCUUCACAAGAAAUUAUAUAAAGGAAAUAUGCCAAGAGGCUGUAUUCCAAAGCCAACUGAAAAGGCUAGAUUUUUGCAAAGGGACACCCGUCCACGGCUUAUAUGGUAAAGAGAAGGCAUAUGGGAGGAAAUACGGAGUCAGGAAAAGCACUUCGUACAAAGGAAAGCCUCACAAGUCACAUGUGAGGAUAGAUAAAAAGAAGCACCUCCUGAUGAAACGAAAAGACUGCAAGUGUUUUGCUUGCGGAGAUAUCGGUCACUUCGCAUCAGAGUGUCCGAAUCCCAAGAAGCUGAUGCACCGAGUUCAAAUUCUACAAUCCUUAGAGCUUGAUGACGGAAUCGACGUAAUCUCCGUAGGAUUUGAUGAGUCAGAUGUCUCAGACAUCUAUUCGGUAUCUGAAGGCGAGGACAGCUACCAGUUCAAUAAUGAGGAUUUUGACGUUAUAGGACAUGACGUGUUCAUGUUCACCAUUGAAGAACAAAGAAACUGCCUGGUAGAAACCACGUCAGCCUGGAGAAGUGCAAUGAAAGUUACUCCAGAAGAAAAGAAUUGCUUACACACAUGGAGCUUUGAGGAAAAGACAACAGACCACUGCAGAGCCUGCAAAAAUCUGGCCCUACGAGGGAGCAGAGCUGACUGCACUCAGUGUAAGAUAAUCAUUUGCUCUUUAUGCAAACCAUACUAUUUCCAGGAUGGUUCACCUAUCCCAGCACAAAGUUCAACCCCAUCAGGAUACUCCUACGAUGAUUGGAUGGGAUCAGCAAAUAGGUGGAAGGCACACUAUGAGUUCUCUCAGGCAAGAAGGAAGAGCCUGAAGGCAGACCUUGAAAGAGCGGAAGAAGAACUAAAAUUUUAUAAGCAAAAGGAAAAGGAAAAGGCCAAAUUAAAGGAUCAAAUUCCAGAAGCAGUACAAGCAAAACUGGAUGAUCUGGAAAAAGAAAAAGAGCUCAAUAACAUCCUAAGAAUAGAGGCUGAGACAGAGCUAAAAGCAUUAAAGGAAAGCUUCAAAGAAAAGGAAGAAGCCCUGAAGGAAGAAAUCACAGCUCUAGAAGAAGAAGUGAGGAUACACAAAGAGGAGGCUGAAGAACUUCAGGAAGAAAAUCAAAAACUCAAAGAGAAGAUCAUAGCCUUCGAAAAAGACGUAACACAAGGACCAGAAGAAGUGAUCGAAUUGGUCAAUAACGUGGAGGAGCACCUGGUACUAACAGGACAACAGAAGAACAAUCUCCUCAACAUCAAGAUAACUCUGGAAGUUAAGGAAAAAAGGAUUACCAUGAACGCGAUACUAGACACUGGAGCCGCAAUCUGUGUCUGUGAUGGGCAAAUGGUAAACGAAUAUUUCAGGAGACCAUCAAUGAUGAAUGCGUUCAUAAAGGGAGUUAAUGGGAUUACCAAUGUCAAAGAAAUCUUAGAGGAAGGAAAAAUCUGGAUUGGUAAUCAAUGGUUCAGAAUCCCAAGGACAUACAUCAUGCCCCAGCUAUCAGAAGGCCUUCAUUUCAUCAUCGGAAUGAACUUUAUCAGGGCAAUGGAAGGAGGGAUUCGAAUUGAGCAAGGAACGGUAACCUUCUACAAAAUGGUUACACAAGCACAGGCACCCCCUAUGGUACACGAUAUUUCUUACCUUGAAGAAUUAGAAUUAGAACUGCCGAUUUACUAUGAUAUCUGUGCAACUAACCCCUCAGGAGGAGAAAUCAAUAGUGACCUAAUAUCCCCCUCGGAGAUCCGGAAACUAAAGGACUUAGGCUACAUUGGGGAAGAGCCCUUGAAACAUUGGGCUAAGAAUCAAGUCAAGUGCCGAAUUGAAAUCAAGAACCCUGACUUAAUCAUUGAAGAUAGGCCCUUGAAGCACGUCACCCCAGCAAUGAAAGAAUCCAUGAAGAAACAUGUGGACAAGCUGCUGGAACUUAAGGUAAUCAGGCCAUCCACAAGCAAACACCGGACGACUGCGAUAAUUGUUCAAUCCGGUACAGAAAUUGACCCCCUCACUGGAAAAGAGAAAAGAGGGAAAGAGAGGCUUGUAUUCAACUACAAACGCCUCAACGACAAUACCGAAAAAGACCAGUAUUCACUACCUGGCAUCAAUACAAUUAUCAGCAGGAUCGGCAAGUCAAAAAUUUACAGCAAAUUUGACUUAAAAUCCGGAUUCCACCAGGUAGCCAUGGAUCCAGAAAGCAUCCCAUGGACGGCCUUUUGGGCCAUAGAUGGACUUUAUGAAUGGCUAGUUAUGCCAUUUGGUCUGAAGAAUGCGCCCGCUAUAUUUCAGAGAAAGAUGGACAACUGCUUCCGAGGAACGGAGGAAUUCAUAGCGGUAUAUAUUGAUGAUAUUUUAAUAUUCUCUGACAAUAUCUCUGAUCACAGGAAACAUCUGUCAAAAUUCCUGGAGAUCUGCAAGGCGAAUGGGCUGGUAUUAAGCCCAACAAAAAUGAAGAUAGGCGCAAAGGAAAUUGAUUUCCUAGGAGCAACUAUUGGAAACUCCAAGAUCAAGCUUCAACCUCAUAUAAUCAAGAAGAUCAUCGAGACAAAGGACGAGGAGCUAAAGGAAACAAAGGGGCUCAGAAAAUGGUUGGGAGUCCUUAACUAUGCACGGGCAUACAUUCCAAAUUUAGGAAAAACAUUAGGCCCGCUCUACUCCAAGACGUCAAUUAAUGGAGAGAAGAAGAUGAACAGCCAAGAUUGGAAGGUUGUUCAACUGAUCAAAAAUCAGGUACAAAAUUUACCUGACCUUGACAUACCCCCUGCAGAGGCAACUAUGGUCUUAGAGACUGACGGGUGUAUGGAAGGAUGGGGAGGAGUAUGCAAAUGGAAGCUCCAUCCCUCUGACACAAGACUGGCAGAAAAGGUCUGUGCGUACGCAAGUGGAAGGUAUCACCCCAUCAAGAGCACAAUUGAUGCAGAGGUACACGCAGUGAUCAACAGCUUAGAAAAAUUCAAAAUUUAUUAUCUGGAUAAAAAGGAGUUGAUCAUAAGAACAGACAGCCAGGCUAUUGUGGCUUUUUAUAAGAAGCAAGCUGAUCAUAAGCCCUCAAGAACAAGGUGGCUUAUGCUAAUUGACUACAUUACUGGGCUCGGAAUCAACGUCAAAUUCGAGCAUAUUGACGGGAAAGAAAAUGUUCUAGCUGAUACUCUAUCAAGGCUGGUCCAAGUGCUGAUCACCAAGGUUCAUCAUCCAGCAGAAACCCAGCUAGUCGAAGCCGUCAUGGAAGUUAUAAGCAAUCCAAAGAAAGAAGCCUUGGACAAGGUAAACCAUUUUAUCUUCCUAACCCAACAGUGGAUUGCAGAACGCAAGGAGGAGCACACGGUGAACACGCUACUCCAGUUGGAAGAACCACAGCUGCAUUGUGGUUGUAGAAACUAUGAAACAGGGGAAAGAAGGAACGCGAUUCUCCUACAAAGUCACACUUCAGCCAACCCGAACAGAUGGUUCUAUAAGUGUGCAGAAAACAAGUGCCACAUUUGGAUCUGGAAAGACAUCCUGGACCAAUAUGCUGAAGAUUAUGCUACCUACACCAGGAUAGGACUUGAAGCACUUAACCUUGAAGAUUGGUUCGAAGAACCAGAACCCGAUCCACCUAACCCUGUGGACCGCCAGAGGAUAGAGGACAUCCUGGACCUACUGAACGUCAGCAAUGACGACUGAAAGAUUCCCAGGACACCGGCGGAAGUGGUGGACCCAGUCUAGGUGCGAUGCUUAGUCGCGCACGAUGACUAUGUCGGAAGGCAUCUUUGCUUUCGGCAAACUUUAGUAAUACUUUAAGGAAAGUAUUGUACAAGUUAGGUGCAGAGACAAUAAUGCACCCAGCUUUAGCUUUGUUUAUGGAAUUAUUGUGUCGGUUGCAUUAUUGGAUGCCUGCGUGCACCCUAAGCAAUCCCCGGCCCUCUUCUCUAUAAGAGGAGCCCUUGCAAUCAGUUGCAAGCAUGCAAGUUUCCCACUGCAAGCUUACUUCUGAGUUUGAGUUCAAGUUCAAUAAAAUUCAAGCUUUCCUCUUACAUUCUGUUCUUGAAAGGUUCGAUCUAAUCGAGCGAGUAGAGAACAAGAUCUUUUGGGAUUUCCGCCGUUCCA"
    #output = runRNAfold(rna)
    output = "UGGUAUCAGAGCAAGGUUUUCUGUAAGUAAUUUAUGGCUUUCAUGGGGUAAAACCCUUAGAUAGGAGCCUGAGGGCUCUGCUAUGUUCUAUUUUGAGAAAAUAACUGUGUAAGUAGUAAUGCAUGAUAAAUCGAAUAAGUUCUUUACGGAUGGUCCUAAAUUUAUGAAAUCAUUCUUUUACUAUCUGAGUGAGACCCUUGUGUUUCCAAGUUCUACUGAGAAAUCAUGAGUAAAUGGACGUUGACACACUGACUUAAGGAAAAGAAAGAUGUGCCUAGGAUGAAGUCGAGCACUGUUCUAGGCUGAAGGGUGAAAAGAAAAAUGAGUUGAGUUGGGAGUAAGACUCUGAGAGGCUUGAGGCAAAAGAACCGGAACCUUACCUAGCAAAGUAAGACCCAAGGGAGGGCAGUAGCUGGAGAACCCCGGUGUGAGUUUCUUUACCUAGCAGAAGAUAUACUCUAGUAUCCUCAAAACACCGUGAAGUAUUUACAACCCUUUAUGAACAAGUAUUUUCUGGAGUUAGAUGUCAGCCACCAAAGAUCAUGAUCUAUCACAAACAAACUUGAGUCAUACAGAGAAGAACUCAGAUGUAACUGAAUGACUAAUGAUCAGGGACCUCUAUUAAAGAGCUUAGUAAGAAGUAAGUGCAUAAACUACCUCUGGAACUGGUUAUAAUCUUGAAAUGAGCAUAUGUAUCCCAAAGGUUACUCCUAUCUGUCCGUGACCAUAAGAAACCUUCUUUAAAGAAAAACUCUGGAUUCCUACUGGGAUCUUGAAUUUGAAAAGUACAAAAACUCUCAUUCCAAAUCUGUUUCAGAUCUUUCUUAUUUAGACUUAGCAUCUGCUGAUAAGGUCUCUAAUAAAGACCUUGCAUUUAAUUUACAUAUAAACACUUAUCGUAGUGAUCUUGGUUUUAAAGUCGCAAUUCACUCUUUAUCAAAAAAUCGUGAGCUGCUAAUACAGAACAGGAAGCUUUUGGAAGAACAAAAGCAGCAGCUGUCUGAAAUUAACAACCUAUCUAAGGUUGUGCGUCUCCAACGAGCUGAUUUAAAGGAGACCUUGAGAAGACAGGACGUCCUUGCGAAGGAGCUUCAGGCUCUUCGUAAAGACUAUCUGGAAAGGCGCCCUCUUAGCAAGGAGGACGUGGAAGAAUUGGUUGUCCGCAUCUCUGAACAACCAAAAAUUUAUUGAAAAAACAGACGGAAGCUCUUACUGAGGAGCUUACAAAGGAGGUUCAGGCACUGAAGCUAAUCAUCCAUAACUUCGAACAGAAGUUACUGGGAUGAGCCUGGCCGGAAGCAAGGCCACAGCAAUCUAUCAAGAAGCCUUGCAAUCUACUGCUGCUGGUUGGGAAGACACCGGCAUCGGAUUUACUGAUAAAGGAGUUAUCAGUACCACUACCCUAUCAAGGCAGCUAAAUUCGCUGUUAUUUCUGGUGAUCAAACAAAAUCAGCAGAUCACCACCAUCUCGGAAGAACUAACCCAACUUCACAACCGGGUUAAAAACCUUGAAGGAAGGACAGGGGUAUCUGCAAGCCCCCUGUAUAAAUCGGAGAUUGAAUCCAUCAACGCCAAGCUCAAAAGUAUUCAAGAUAUACAAGGGAGUCACCCUCCAAAAGAGACCCCCUCCGGAGUUAUCAAAGUUUUUGAGGAUCCCUACAGCAUCCUCCGCAGACUAUAAAUGGCGUCAAGACCUAGAGUUUCUGGGAGCACUACCAGAACCAUGAUAGCAGAACCAGGGGUUCCCCUGGUGGAUGAUCAGAUCCGGGAAUACCGGAGUGCGGCCCGAGUCGCAUACGAAGCACAAAGGAUUGCCAGACGCACUGGCAAUAUUCUUGGAAGAAUUGUUGGACGACAACCAAGGGAGCAUACCCUUGCGAUGGUCGUGGACCCCAACAGUGAGCUGGAACGCUCACUGGCUCACCGGGCACGAACAAUACCUGCUGAAGUCCUUUACAUGACCCAGCGCGGUGAGCCUACAAAUCGGGUCUAUCGGAACAGAACUGAAGAAAGGAUGCUAGUGACUCAUGGUCAGCAAGAUAGGACUUUCAUCUUGCCAGAGUCAUAUGAAGAGCUCAGGGAGGCUGGAUUUGAGUACAUCCAUCUAGGGGUACUCCAGGUGCGCAUCCAAAUUAUGCACCGAACAUAUGAUGGUACAAUGGCAUUAGUGGUCUUCCGUGACACCAGAUGGACACAGGAGAACCACCAAGACAGAUCCAUUAUAGCAACCAUGGAGGCUGAUCUCUCCCAAGGGCAUCAGCUAAUUUACGUCAUCCCAGAUAUAAUGAUGACUAUUCGGGAUUUCUACCAGCACAUUCAGAUAAGCAUCCUUACCAAAGGAUAUGAAGGCUUUCAAGGAGAAGCAAAUCUCCUUAUUACAAGAAGCUGCCGGUGCAGAUUAAGCAACGUUCCUAACGUUGGCUUCCAAUACAACAUCCAGAACGUCGUGGAAUUCUUAAAAUCUAGGGGAGUAAAAGCCCUAAAUGCGACGAAAUUAAGCACCAGGAGGUUCCAAGGAGGAGAAUGGAACAUCCGACCAUCAGAAGUGGUGGUCCCUAUGCAGCCAACAACUAUGAUAGUACGAGUUAAUUAUGACUCGUCACGAAGCAUCAGAUUCGGGGAUUAUGAAGCUAGCACAUCAUCAUCAGCCCCGAGAUAUGAGCAAGACGGUGAUGAAGAUGAAGCACUUGGUGAUAUCCAUCAAGUAAAUAUGAUCACCAUCAUAGAAGAUGAUGCAGAAGAUGACUACCCACGGUUAUCAGCUUUAGAGCGAAUAAUCGCUCCAGAAAGCAUGGUGGGAGAGGAGGACACAAUUGCUGAAUUUUUAAGCAAUCUGUCCUUAGAUUCCUCCACUGAUGAGGAAUUCUACGACGCCGACAACUCAUUAUUCGAAGAAGAAGAAUAUGAUGGGGAUUCCGAAGUUAGCACCCCAAGGAGCAAAUACAAUAUAUUUGCGCUAGAAGAUGAGUACCCAAAACUUCAACAGCUGGAAAGCCUGGUACUCUCCACAACAGAGUCUGCUAUCAGUCGCUUUAGACCAGCAGACACAGAUAUGACUGGCGUAGGCCCUGGCUACGCACCAGCAACUGGAACAGCUGGCUAUACUGGAGCCAGUUCAUCUGAUUUCCCUUACCCUAGAAGACCAAGAAAGUGGGACAACAACUCGGAGUGGUUCAACCUACCCACCGCUAACGCGAGGCAAGCAUCAAUAUUCGUUAUGCCUCAGGAUUUUGACACAAAGGUCUUUGAAAGAUGGGAAAGUUCUGUUCUCCUUCACAUGUCUGACAAGGUUUUUGAUGAUCCACAAGACAAGUUAACUUAUGUGGAAAACCUACUAGGAGAAUCAGAAAAGAAGAUGUUUAUCACUUGGAGGAUGAUGUUCACAGCUGAGUACGAAGAAAUGAAGAACAACGCUCUCGGCUCAAAUGGAACUCAAAAUAUCCUGAACCAGAUCAGGAUGAUAUUCUUUCUGGAAAAUCCCCAAGUUGGAACCACCAACACUCAAGACGCAGCAUACAAGACACUCAAACAACUAGUCUGCACAGAGAUGUCUGGACCUGCGAUCUACAGGUACCUAAAUGAUUACUUCCAUUUAGCGGCAAAAUCUGGAAGAGCGUGGGCAUCUGAUGAGCUGUCCAAGGAAUUCUUUACAAAACUGCCAAGGGGAUUAGGGGACAGAGUUGAAAAGAAAUUCAAAGAAAAGUACCCCAACAACACUAUUGGAGUAGCCCCCAGAAUCACCUUCACAAGAAAUUAUAUAAAGGAAAUAUGCCAAGAGGCUGUAUUCCAAAGCCAACUGAAAAGGCUAGAUUUUUGCAAAGGGACACCCGUCCACGGCUUAUAUGGUAAAGAGAAGGCAUAUGGGAGGAAAUACGGAGUCAGGAAAAGCACUUCGUACAAAGGAAAGCCUCACAAGUCACAUGUGAGGAUAGAUAAAAAGAAGCACCUCCUGAUGAAACGAAAAGACUGCAAGUGUUUUGCUUGCGGAGAUAUCGGUCACUUCGCAUCAGAGUGUCCGAAUCCCAAGAAGCUGAUGCACCGAGUUCAAAUUCUACAAUCCUUAGAGCUUGAUGACGGAAUCGACGUAAUCUCCGUAGGAUUUGAUGAGUCAGAUGUCUCAGACAUCUAUUCGGUAUCUGAAGGCGAGGACAGCUACCAGUUCAAUAAUGAGGAUUUUGACGUUAUAGGACAUGACGUGUUCAUGUUCACCAUUGAAGAACAAAGAAACUGCCUGGUAGAAACCACGUCAGCCUGGAGAAGUGCAAUGAAAGUUACUCCAGAAGAAAAGAAUUGCUUACACACAUGGAGCUUUGAGGAAAAGACAACAGACCACUGCAGAGCCUGCAAAAAUCUGGCCCUACGAGGGAGCAGAGCUGACUGCACUCAGUGUAAGAUAAUCAUUUGCUCUUUAUGCAAACCAUACUAUUUCCAGGAUGGUUCACCUAUCCCAGCACAAAGUUCAACCCCAUCAGGAUACUCCUACGAUGAUUGGAUGGGAUCAGCAAAUAGGUGGAAGGCACACUAUGAGUUCUCUCAGGCAAGAAGGAAGAGCCUGAAGGCAGACCUUGAAAGAGCGGAAGAAGAACUAAAAUUUUAUAAGCAAAAGGAAAAGGAAAAGGCCAAAUUAAAGGAUCAAAUUCCAGAAGCAGUACAAGCAAAACUGGAUGAUCUGGAAAAAGAAAAAGAGCUCAAUAACAUCCUAAGAAUAGAGGCUGAGACAGAGCUAAAAGCAUUAAAGGAAAGCUUCAAAGAAAAGGAAGAAGCCCUGAAGGAAGAAAUCACAGCUCUAGAAGAAGAAGUGAGGAUACACAAAGAGGAGGCUGAAGAACUUCAGGAAGAAAAUCAAAAACUCAAAGAGAAGAUCAUAGCCUUCGAAAAAGACGUAACACAAGGACCAGAAGAAGUGAUCGAAUUGGUCAAUAACGUGGAGGAGCACCUGGUACUAACAGGACAACAGAAGAACAAUCUCCUCAACAUCAAGAUAACUCUGGAAGUUAAGGAAAAAAGGAUUACCAUGAACGCGAUACUAGACACUGGAGCCGCAAUCUGUGUCUGUGAUGGGCAAAUGGUAAACGAAUAUUUCAGGAGACCAUCAAUGAUGAAUGCGUUCAUAAAGGGAGUUAAUGGGAUUACCAAUGUCAAAGAAAUCUUAGAGGAAGGAAAAAUCUGGAUUGGUAAUCAAUGGUUCAGAAUCCCAAGGACAUACAUCAUGCCCCAGCUAUCAGAAGGCCUUCAUUUCAUCAUCGGAAUGAACUUUAUCAGGGCAAUGGAAGGAGGGAUUCGAAUUGAGCAAGGAACGGUAACCUUCUACAAAAUGGUUACACAAGCACAGGCACCCCCUAUGGUACACGAUAUUUCUUACCUUGAAGAAUUAGAAUUAGAACUGCCGAUUUACUAUGAUAUCUGUGCAACUAACCCCUCAGGAGGAGAAAUCAAUAGUGACCUAAUAUCCCCCUCGGAGAUCCGGAAACUAAAGGACUUAGGCUACAUUGGGGAAGAGCCCUUGAAACAUUGGGCUAAGAAUCAAGUCAAGUGCCGAAUUGAAAUCAAGAACCCUGACUUAAUCAUUGAAGAUAGGCCCUUGAAGCACGUCACCCCAGCAAUGAAAGAAUCCAUGAAGAAACAUGUGGACAAGCUGCUGGAACUUAAGGUAAUCAGGCCAUCCACAAGCAAACACCGGACGACUGCGAUAAUUGUUCAAUCCGGUACAGAAAUUGACCCCCUCACUGGAAAAGAGAAAAGAGGGAAAGAGAGGCUUGUAUUCAACUACAAACGCCUCAACGACAAUACCGAAAAAGACCAGUAUUCACUACCUGGCAUCAAUACAAUUAUCAGCAGGAUCGGCAAGUCAAAAAUUUACAGCAAAUUUGACUUAAAAUCCGGAUUCCACCAGGUAGCCAUGGAUCCAGAAAGCAUCCCAUGGACGGCCUUUUGGGCCAUAGAUGGACUUUAUGAAUGGCUAGUUAUGCCAUUUGGUCUGAAGAAUGCGCCCGCUAUAUUUCAGAGAAAGAUGGACAACUGCUUCCGAGGAACGGAGGAAUUCAUAGCGGUAUAUAUUGAUGAUAUUUUAAUAUUCUCUGACAAUAUCUCUGAUCACAGGAAACAUCUGUCAAAAUUCCUGGAGAUCUGCAAGGCGAAUGGGCUGGUAUUAAGCCCAACAAAAAUGAAGAUAGGCGCAAAGGAAAUUGAUUUCCUAGGAGCAACUAUUGGAAACUCCAAGAUCAAGCUUCAACCUCAUAUAAUCAAGAAGAUCAUCGAGACAAAGGACGAGGAGCUAAAGGAAACAAAGGGGCUCAGAAAAUGGUUGGGAGUCCUUAACUAUGCACGGGCAUACAUUCCAAAUUUAGGAAAAACAUUAGGCCCGCUCUACUCCAAGACGUCAAUUAAUGGAGAGAAGAAGAUGAACAGCCAAGAUUGGAAGGUUGUUCAACUGAUCAAAAAUCAGGUACAAAAUUUACCUGACCUUGACAUACCCCCUGCAGAGGCAACUAUGGUCUUAGAGACUGACGGGUGUAUGGAAGGAUGGGGAGGAGUAUGCAAAUGGAAGCUCCAUCCCUCUGACACAAGACUGGCAGAAAAGGUCUGUGCGUACGCAAGUGGAAGGUAUCACCCCAUCAAGAGCACAAUUGAUGCAGAGGUACACGCAGUGAUCAACAGCUUAGAAAAAUUCAAAAUUUAUUAUCUGGAUAAAAAGGAGUUGAUCAUAAGAACAGACAGCCAGGCUAUUGUGGCUUUUUAUAAGAAGCAAGCUGAUCAUAAGCCCUCAAGAACAAGGUGGCUUAUGCUAAUUGACUACAUUACUGGGCUCGGAAUCAACGUCAAAUUCGAGCAUAUUGACGGGAAAGAAAAUGUUCUAGCUGAUACUCUAUCAAGGCUGGUCCAAGUGCUGAUCACCAAGGUUCAUCAUCCAGCAGAAACCCAGCUAGUCGAAGCCGUCAUGGAAGUUAUAAGCAAUCCAAAGAAAGAAGCCUUGGACAAGGUAAACCAUUUUAUCUUCCUAACCCAACAGUGGAUUGCAGAACGCAAGGAGGAGCACACGGUGAACACGCUACUCCAGUUGGAAGAACCACAGCUGCAUUGUGGUUGUAGAAACUAUGAAACAGGGGAAAGAAGGAACGCGAUUCUCCUACAAAGUCACACUUCAGCCAACCCGAACAGAUGGUUCUAUAAGUGUGCAGAAAACAAGUGCCACAUUUGGAUCUGGAAAGACAUCCUGGACCAAUAUGCUGAAGAUUAUGCUACCUACACCAGGAUAGGACUUGAAGCACUUAACCUUGAAGAUUGGUUCGAAGAACCAGAACCCGAUCCACCUAACCCUGUGGACCGCCAGAGGAUAGAGGACAUCCUGGACCUACUGAACGUCAGCAAUGACGACUGAAAGAUUCCCAGGACACCGGCGGAAGUGGUGGACCCAGUCUAGGUGCGAUGCUUAGUCGCGCACGAUGACUAUGUCGGAAGGCAUCUUUGCUUUCGGCAAACUUUAGUAAUACUUUAAGGAAAGUAUUGUACAAGUUAGGUGCAGAGACAAUAAUGCACCCAGCUUUAGCUUUGUUUAUGGAAUUAUUGUGUCGGUUGCAUUAUUGGAUGCCUGCGUGCACCCUAAGCAAUCCCCGGCCCUCUUCUCUAUAAGAGGAGCCCUUGCAAUCAGUUGCAAGCAUGCAAGUUUCCCACUGCAAGCUUACUUCUGAGUUUGAGUUCAAGUUCAAUAAAAUUCAAGCUUUCCUCUUACAUUCUGUUCUUGAAAGGUUCGAUCUAAUCGAGCGAGUAGAGAACAAGAUCUUUUGGGAUUUCCGCCGUUCCA\n" \
"((((.(((((((((((((((((.(((((..(((((((...(((((((..........(((((((((((((..(((...((((((((((.(((((((((..((((((((....(((((.((((((..((..((...(((((((((((.(((.((((((....((((....((((((..((((.((((((((.......((((((..(((((((....(((...(((((((.....(((..(((((((..(((((((.((((((..........(((((((((..(((.....))))))))))))((((((((...........((((..((....((((((...(((((..(((...(((((......(((((...(((((........))))).(((......)))(((...))).......)))))....)))))....)))..))).))...))))))....)))))).......(((((...))))).))))))))..........)))))).))))))).)))))))..)))....)))))))...)))......)))))).)..))))))......))))))))))))..))))))...))))...)))))))))..)))))))))))....))..)).))))))..))))).......)).))))))..)))))))))))))))).))).)))..)))...)))))))))))))))))))))))).....((((....))))....((.(((((((....))))))).))...(((..(((......))).)))......(((((...)))))...(((.....))).(((((....)))))((((((((.......))))))))...................((((......)))).(((((.((((......(((.(((((..(((......)))..))))).)))......))))))))).(((((((......)))))))..(((((((..((.((..(((((((.....)))))))..)).))..)).)))))))))).)))))))))))......((((..(((.((((((((.((((...)))))))))))).)))..)))).........((((((....))))))..(((((.((.....)).)))))..))))))...))))...................(((((((((((((....)))))))).......((.(((((...))))).))..((((((.(((((((.....)))))))...))))))((.(((((........)))))..))(((((...((((...((((...(((((((((((((((.(......))))))))..((...(((((((((.....))))))))))).((..(((.((((((((((.......)))).......((((((((..............))))))))((.....))......((((((............))))))....)))))))))..))(((((((...........))))))).....((((((((((((((..((((((((((((((....((((.......)))).((((.(((.............))).))))...))))).....(((((..(((((((......).))))))...))))).....))))))..((((((.((..((((((........))))))...((((......(((((((....))))))).....))))..(((((.....)))))(((((((....)))))))..............((((((((.....))))))))(((((....)))))(((((((((((..(((((((......)))))).)...))))).....))))))((((((......)))))).(((((((((((...........))(((((..(((........))).))))))))))))))......))))))))...(((((((((.((((((..(((.(((.(((((((.((....(((((((.((....)))))))))))))))))).(((((((((((((((.(((((....((((((.(((.....)))))))))..(((((((((((((...((((((((((((((((((((.....((...((.(((((((((.(((...((....)).))).)))).))))).))..))...))))))))....((((((((((((((((((....)))).))))))).......((((((...........)))))).....(((...(((((((.........((.((((((((((....))))))......))))))(((((((......)))))))...........(((((((((.........(((((((...))))))).(((((((...............((((((((((((((...((((((((.........)))))..(((...........)))...(((.((((((..........)))))).)))((((((((....))))))))....((((..((.(..(((((((.((((((((((....)))))))).))...((.(((..(((((((...((((.............))))...)))))))...))))).....((((((.(..((.....((((((((.....))))))))..)).).)))))))))))))..).)).))))...(((((((......))))))).(((((.((((((....))))))...))))).(((.((((...(((((((..((((((.........)))))).)))))))...)))).)))..))).))))))))))))))((((.....((((.((((.........))))))))((((((((((((((......((((((((((((((((.....))))))).......((.(((((((......((((.....))))......))))))))).........(((((((....(((......))).))))))).(((......)))((((((.(...).)))))).((((...))))...((((((((.......))))))))(((((..((((((........(((((((......(((((.....((((......)))).......))))).((....))(((((((((..........))).))))))................))))))).......)))))).(((((((((((((((((((..((((...(((((((......)).)))))..))))...)))))))..........))))))).)))))....)))))....)).))))).)).(((.((((.((..(((((.(((((...((.....))...)).))))))))..)))))))))...((((((((......))))))))......)))).)))..))))))).(((((.....))))).((..((((((((....((.(((((((..................))).))))))...))))).)))..))....(((((((........))))))))))).....(((((..((((((..((.(((.((.(((((((((((..((((((......((((((.((((((..((((((....(((((......)))))......)).)))).....(((((((((.....((((........(((((((...............(((((((.(((....)))))).))))...((...((.....(((((((((((((((...((((....)))).(..((((((((.(........).))))))))..).....((..(((((((...(..((((.............(((((((.......)))))))...........))))..).)))))))....))......((((((((.....)))))))).(((.((((.(((((.......))))).))))))).......(((..((((..(.(((.....(((....((((((((((((.((((((((............))))).((((....(((((.(((((((...))))))))))))..))))...((((.((....(((((((((((((..((((.((....(((((((.....)))))))....)).))))..))))))...............)))))))...)).))))...((((((((.(........).)).)))))).....................))).))))))))))))..))).....))))..)))).))).))))))))))))))).....))...))(((((((.(((..((((((.(..........(((((.......))))).....((((((..((((((.(((((((((((((........(((((...((((((((...))))..)))).))))))))))........))))))))((.....)).((((((((.((((((...........)))))).(((...((((......((...((((.........))))....))........)))).....)))........((((((...(((((..((.......))....)))))))))))............))))))))....))))))..))))))).)))))).))).(((...))).....(((...(((((............))))))))..............)))))))..........(((......))).....((((((((..((.((((.........................)))).)).))))))))...................((((((..((.....))...))))))......)))))))....((((.......)))).................((((.(((.((.(((....))).)).))).)))).....((....))(((((((((....(((((((.(((.......))))))))))((((((.....(((............))).....))))))........)))))))))..((((.((((....((((((((((.(((......((((......))))......)))))))))))))....((((((((((((.........(((..(((((..(((.......))).((((((((......))))))))........))))))))......)))))))....)))))........((((((...........))))))....(((((((.......(((((((..((.((.((((....((((....))))....)))).)).))...)))))))...)))))))...))))))))..)).)).....))))))))).......))))))(((((.((((..................((((((.((((((((.(((((..........))))).......((((((.(.(.....(((....)))....)))))))).....(((..(((.((((..(((.((........((((((.((......((((((........))))))))...))))))........))..))))))))))..))).......(((((((((((((((((((((...((((((((..(((((((...(((((................))))).....((((((((((......)))))..)))))..((.......))........)))).)))..)))).)).))....))))))))).))))..)))..((((((((.............))))))))....))))).)))).))))))))))((((.(((((((.((.(((...)))..)).)))))))))))...((((((....(((((((.......))))))))))))).....(((((((((((((((((((((((.........((((((((((.....)))).........))))))...((((((.......)))))))))))))).)))))..(.((((.((((((.............))))))..)))).)...))))..((((((.......))))))...............)))))).((((((....)))))).(((((.....(((((...)))))......)))))...................)))).)))))............(((((..............))))).....(((((((((....)))))))))...(((((.....((((.......)))).........))))).(((.(((((.............))))))))...((.(((((((((..........))))))))).)).........(((((((.......)))))))((((..(((((.(((..(((((((.......))))......)))..))).))))).))))...(((((((((.(.(....).).))))).))))(((......))).)))))).....((((((((((((....)))....(((((.(..((((((........))))))..).))))).))))(((((((((..(((......(((((............)))))...)))..))))))))).....)))))..(((((((..(((..(((.....)))..))))))....((((((((.((........)).))))))))................))))(((((((............)))))))....((((((....((.......(((((((....(((......(((((.....(((.(((.(......).))).)))))))))))....)))))))))....))))))((((.(((...)))..))))...)))))).))))))))).((....))......((((((....(((....))).((((.....)))))))))))).)))))))..))))))..))))))))))))..((((((.....))))))((((((((.((((......(((....((((....((..............))....))))......)))......))))))))))))(((.(((.........))))))...((((((.((......(((((((........((..........))........)))))))....(((.(((........))).))).(((((((...)))))))..)).))))))(((...(((.(((....))).)))....)))...((((((..((......(((((....)))))......))....)))))))))))))))...))))))))))((((..((((((((.....))))))).)...)))).(((((.((((((....)))))))))))(((((...(((((((((....)))))))))...))))).((((((..........)))))).(((....)))...)))))))......))).)))).)))))..))))))))......))))))).)))..)))).(((((((((......)))))).)))(((((((....)))))))..((((.((.....))))))((((((....)))))))))))))...))))..........)))..))))))).))))))))))))))..))))))))))..)))))).))))))...)))).))))...)))))....)))))... (-2272.40)"
    print output
    print get_sec_struc(output)
    print get_score(output)
    name = "test1"
    struct = get_sec_struc(output)
    runRNAplot(name, rna, struct)
